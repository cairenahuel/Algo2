\documentclass[../../document.tex]{subfiles}
\begin{document}
\begin{proc}{individuoDecideSiCooperarONo}{\In individuo: \nat, \In recursos: \TLista{\float}, \Inout cooperan: \TLista{\bool}, \In apuestas : \TLista{\TLista{\float}}, \In pagos : \TLista{\TLista{\float}}, \In eventos : \TLista{\TLista{\nat}}}{}
    \requiere{cooperan=COOPERAN_0}
    \requiere{todosPositivos(recursos)}
    \requiere{|recursos|=|cooperan|=|eventos|=|pagos|=|apuestas|}
    \requiere{esRectangular(eventos)\yLuego esRectangular(pagos)\yLuego esRectangular(apuestas)}
    \requiere{\paraTodo[unalinea]{i}{\ent}{(enRango(i, eventos) \yLuego |eventos[i]|>0}}
    \requiere{\paraTodo[unalinea]{i}{\ent}{(enRango(i, |cooperan|) \yLuego (|pagos[i]|=|apuestas[i]|)}}
    \requiere{enRango(individuo, cooperan)}
    \requiere{\paraTodo[unalinea]{i}{\ent}{enRango(i, cooperan)\yLuego \sum_{k=0}^{|apuestas|-1}apuestas[i][k] = 1}}

    \asegura{|cooperan|=|COOPERAN_0|}
    \asegura{\paraTodo[unalinea]{i}{\ent}{i\not=individuo\yLuego cooperan[i]=COOPERAN_0[i]}}
    \asegura{\existe[unalinea]{tfc, tfnc}{\TLista{\TLista{\float}}}{|tfc|=|cooperan|\land |tfc[0]|+1=|eventos[0]| \land esRectangular(tfc) \yLuego
    \\esTrayectoriaValida(tfc, setKey(cooperan,individuo,true),apuestas, pagos, eventos)\yLuego
    \\|tfnc|=|cooperan|\land |tfnc[0]|+1=|eventos[0]| \land esRectangular(tfnc) \yLuego
    \\esTrayectoriaValida(tfnc, setKey(cooperan,individuo,false),apuestas, pagos, eventos)\yLuego
    \\(tfc[individuo][|evento[0]|]\geq tfnc[individuo][|evento[0]|]\sii cooperan[individuo]=true)}}
    \salto{\baselineskip}
    \pred{esTrayectoriaValida}{tr: \TLista{\TLista{\float}},co: \TLista{\bool},ap: \TLista{\TLista{\float}},pa: \TLista{\TLista{\float}},ev: \TLista{\TLista{\ent}}}{\paraTodo[unalinea]{t}{\nat}
    {enRango(t, eventos[1])\yLuego
    \paraTodo[unalinea]{i}{\ent}{enRango(i, eventos)\yLuego \\tr[i][t+1]=ufcPaso(t,tr,co,ap,pa,ev)+\IfThenElse{co[i]}{0}{tr[i][t]*ap[i][ev[i][t]]*pa[i][ev[i][t]]}}}
    }
    \begin{adjustwidth}{1em}{}
        \donde{tfc=trayectoriaFinalCooperando}
        \donde{tfnc=trayectoriaFinalNoCooperando}
    \end{adjustwidth}
\end{proc}
\end{document}